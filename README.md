# reaction-docs

üìù `reaction-docs` is the new static documentation generator for all Reaction Commerce projects.

## Requirements

- Node, 6.x and above
- Yarn
- Docker

## Stack

- [Docusaurus](https://github.com/facebook/docusaurus/), for static-site documentation generation
- Markdown for Docs
- React for components
- [highlight.js](https://github.com/isagalaev/highlight.js) for JavaScript, HTML, CSS, shell syntax highlighting
- [Prism.js](https://prismjs.com/) for JSX, GraphQL syntax highlighting
- [Algolia DocSearch](https://community.algolia.com/docsearch/)
- ESLint configured with Reaction Commerce eslint config
- LiveReload during development
- Docker

## Getting started contributing docs

### Run the app locally

```
git clone git@github.com:reactioncommerce/reaction-docs.git
cd reaction-docs
bin/setup
docker-compose up
```

Open `localhost:4242`

### Add or update Markdown files

1. Add a new Markdown file in `public-docs`.
1. At the start of the file, add the required frontmatter:
```md
---
id: doc2
title: document number 2
---
```
1. Add the Markdown file to the table of contents, at `website/sidebars.json`
1. The server uses LiveReload, so as soon as you save, you should see the changes at `localhost:4242`.

For more Markdown features, including autogenerated table of contents, refer to [Docusaurus docs](https://docusaurus.io/docs/en/doc-markdown.html).

### Tips for documenting

- To add images, save the image in website/static/assets and reference it like this:

```md
![](/assets/admin-dashboard.png "Reaction Dashboard")
```

- To link to other articles, reference other articles by their filename:

```md
Refer to the [FAQs](faqs.md) article
```

- To enable code syntax highlighting, add `js`, `jsx`, `graphql`, `html`, `sh`, `git`, `yaml` and [more](https://github.com/reactioncommerce/reaction-docs-static/issues/47) after the ```.

### Sign your commits

Contributing to the Reaction Docs requires signing your work by way of signed Git commits.

As a contributor, we want to make sure that you understand your rights as the copyright holder. We also want to make sure that contributions done on behalf of companies (i.e. by their employees) are submitted with the acknowledgement that the contributor (employee) isn't the copyright holder (employer).

This repository is using a Developer Certificate of Origin (DCO), by way of signed commits, to help contributors acknowledge that they're aware of their rights, and that they have the authority to submit their contributions either on their or on their employer's behalf.

To sign off on the DCO for your commits, use the command `git commit -s` which adds a line to every commit that looks like this:

`Signed-Off-By: Jane Doe <jane@example.com>`

We do ask that you use your full name and a valid email address in this process.

The DCO signoff is attached to every single commit, thereby stating that the committer agrees to the DCO as shown below or on <https://developercertificate.org/>.

```
Developer's Certificate of Origin 1.1

By making a contribution to this project, I certify that:

(a) The contribution was created in whole or in part by me and I
    have the right to submit it under the open source license
    indicated in the file; or

(b) The contribution is based upon previous work that, to the
    best of my knowledge, is covered under an appropriate open
    source license and I have the right under that license to   
    submit that work with modifications, whether created in whole
    or in part by me, under the same open source license (unless
    I am permitted to submit under a different license), as
    Indicated in the file; or

(c) The contribution was provided directly to me by some other
    person who certified (a), (b) or (c) and I have not modified
    it.

(d) I understand and agree that this project and the contribution
    are public and that a record of the contribution (including
    all personal information I submit with it, including my
    sign-off) is maintained indefinitely and may be redistributed
    consistent with this project or the open source license(s)
    involved.
```

## Developing

The Header, Footer, index page and version pages are developed in React and CSS within the `website/core` and `website/static` directories. Site configuration details are managed in `website/siteConfig.js`.

### Logging

```sh
docker-compose up -d && docker-compose logs -f
```

### Linting

```sh
docker-compose run --rm web yarn lint
```

```sh
docker-compose run --rm web yarn lint:fix:eslint
```

### Running commands

`docker-compose run --rm web [...]` will run any command inside a Docker container and then remove the container.

### Restart

```sh
docker-compose run --rm web yarn install \
&& docker-compose down --rmi local \
&& docker-compose build \
&& docker-compose up
```

### Tests

Tests are stubbed out for now.

## Versioning

Add a new version

```sh
docker-compose run --rm web yarn run version <version>
```

Rename an existing version to a new name

```sh
docker-compose run --rm web yarn run rename-version <currentVersion> <newVersion>
```

See [Versioning guide](https://docusaurus.io/docs/en/1.1.4/versioning.html) for more.

## Releasing a new version

1. Add a new version

```sh
docker-compose run --rm web yarn run version <version-number>
```

2. Restart the container:

```sh
docker-compose down && docker-compose up
```

3. Run locally to confirm the version number has been changed on `localhost:4242`, and the previous version has been added to `localhost:4242/versions` list.

4. If all things look good, push the branch up to make a pull request.

5. Merge to `master` to auto-deploy

## Deploying

### Merge to `staging` branch

Merging to `staging` will trigger a CircleCI build to https://reaction-docs-staging.reactioncommerce.com/

### Merge to `master` branch

Merging to `master` will trigger a CircleCI build to http://reaction-docs-production.netlify.com
